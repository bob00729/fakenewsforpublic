bringToFront = TRUE),
popup = paste("Region:", US_map$NAME,"<br/>",
"Confidence in Press:", round(as.numeric(US_map$Press), 2),"<br/>",
"Confidence in TV:", round(as.numeric(US_map$TV), 2),"<br/>",
"Confidence in Congress:", round(as.numeric(US_map$Congress), 2)),
group = "Confidence in the Press") %>%
addPolygons(fillColor = ~colorNumeric("RdYlGn", Congress)(Congress), stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = paste("Region:", US_map$NAME,"<br/>",
"Confidence in Press:", round(as.numeric(US_map$Press), 2),"<br/>",
"Confidence in TV:", round(as.numeric(US_map$TV), 2),"<br/>",
"Confidence in Congress:", round(as.numeric(US_map$Congress), 2)),
group = "Confidence in the Congress") %>%
addLayersControl(
baseGroups = c("Confidence in the Press", "Confidence in the Congress"),
options = layersControlOptions(collapsed = TRUE))
leaflet(US_map) %>% addTiles() %>%
addProviderTiles(providers$Stamen.Toner, group = "Toner") %>%
setView(lat=38.0000, lng=-97.0000, zoom = 4) %>%
addLegend("bottomright", colors = brewer.pal(4, "RdYlGn"),
labels = c("Lowest", "Low", "Medium", "High"),
title = "Level of Confidence<br/>(use layers to change variables)",
opacity = 0.5) %>%
addPolygons(fillColor = ~colorNumeric("RdYlGn", Press)(Press), stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = paste("Region:", US_map$NAME,"<br/>",
"Confidence in Press:", round(as.numeric(US_map$Press), 2),"<br/>",
"Confidence in TV:", round(as.numeric(US_map$TV), 2),"<br/>",
"Confidence in Congress:", round(as.numeric(US_map$Congress), 2)),
group = "Confidence in the Press") %>%
addPolygons(fillColor = ~colorNumeric("RdYlGn", Congress)(Congress), stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = paste("Region:", US_map$NAME,"<br/>",
"Confidence in Press:", round(as.numeric(US_map$Press), 2),"<br/>",
"Confidence in TV:", round(as.numeric(US_map$TV), 2),"<br/>",
"Confidence in Congress:", round(as.numeric(US_map$Congress), 2)),
group = "Confidence in the Congress") %>%
addPolygons(fillColor = ~colorNumeric("RdYlGn", Age)(Age), stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = paste("Region:", US_map$NAME,"<br/>",
"Confidence in Press:", round(as.numeric(US_map$Press), 2),"<br/>",
"Confidence in TV:", round(as.numeric(US_map$TV), 2),"<br/>",
"Confidence in Congress:", round(as.numeric(US_map$Congress), 2)),
group = "Age") %>%
addLayersControl(
baseGroups = c("Confidence in the Press", "Confidence in the Congress", "Age"),
options = layersControlOptions(collapsed = TRUE))
US_map <- tigris::divisions()
gss_by_reg <- gss_16 %>% dplyr::group_by(region) %>%
dplyr::summarize(General = mean(trust, na.rm = TRUE),
Press = mean(conpress, na.rm = TRUE),
TV = mean(contv, na.rm = TRUE),
Finance = mean(confinan, na.rm = TRUE),
Business = mean(conbus, na.rm = TRUE),
Religion = mean(conclerg, na.rm = TRUE),
Education = mean(coneduc, na.rm = TRUE),
Exec_fed_gov = mean(confed, na.rm = TRUE),
Unions = mean(conlabor, na.rm = TRUE),
Medicine = mean(conmedic, na.rm = TRUE),
Supreme_court = mean(conjudge, na.rm = TRUE),
Science_comm = mean(consci, na.rm = TRUE),
Congress = mean(conlegis, na.rm = TRUE),
Military = mean(conarmy, na.rm = TRUE),
Age = mean(age, na.rm = TRUE),
Foreign = mean(born, na.rm = TRUE),
Party = mean(as.numeric(partyid, na.rm = TRUE)))
gss_by_reg <- data.frame(sapply(gss_by_reg, function(x) as.numeric(as.character(x))))
gss_by_reg$region <- as.character(gss_by_reg$region)
US_map@data <- US_map@data %>%
left_join(gss_by_reg, by = c("DIVISIONCE" = "region"))
US_map <- tigris::divisions()
gss_by_reg <- gss_16 %>% dplyr::group_by(region) %>%
dplyr::summarize(General = mean(trust, na.rm = TRUE),
Press = mean(conpress, na.rm = TRUE),
TV = mean(contv, na.rm = TRUE),
Finance = mean(confinan, na.rm = TRUE),
Business = mean(conbus, na.rm = TRUE),
Religion = mean(conclerg, na.rm = TRUE),
Education = mean(coneduc, na.rm = TRUE),
Exec_fed_gov = mean(confed, na.rm = TRUE),
Unions = mean(conlabor, na.rm = TRUE),
Medicine = mean(conmedic, na.rm = TRUE),
Supreme_court = mean(conjudge, na.rm = TRUE),
Science_comm = mean(consci, na.rm = TRUE),
Congress = mean(conlegis, na.rm = TRUE),
Military = mean(conarmy, na.rm = TRUE),
Age = mean(age, na.rm = TRUE),
Foreign = mean(born, na.rm = TRUE),
Party = mean(7 - as.numeric(partyid, na.rm = TRUE)))
gss_by_reg
gss_by_reg$Party
gss_by_reg <- gss_16 %>% dplyr::group_by(region) %>%
dplyr::summarize(General = mean(trust, na.rm = TRUE),
Press = mean(conpress, na.rm = TRUE),
TV = mean(contv, na.rm = TRUE),
Finance = mean(confinan, na.rm = TRUE),
Business = mean(conbus, na.rm = TRUE),
Religion = mean(conclerg, na.rm = TRUE),
Education = mean(coneduc, na.rm = TRUE),
Exec_fed_gov = mean(confed, na.rm = TRUE),
Unions = mean(conlabor, na.rm = TRUE),
Medicine = mean(conmedic, na.rm = TRUE),
Supreme_court = mean(conjudge, na.rm = TRUE),
Science_comm = mean(consci, na.rm = TRUE),
Congress = mean(conlegis, na.rm = TRUE),
Military = mean(conarmy, na.rm = TRUE),
Age = mean(age, na.rm = TRUE),
Foreign = mean(born, na.rm = TRUE),
Party = mean(as.numeric(partyid, na.rm = TRUE)))
gss_by_reg$Party
table(gss_16$partyid)
class(gss_16$partyid)
levels(gss_16$partyid)
gss_by_reg <- gss_16 %>% dplyr::group_by(region) %>%
dplyr::summarize(General = mean(trust, na.rm = TRUE),
Press = mean(conpress, na.rm = TRUE),
TV = mean(contv, na.rm = TRUE),
Finance = mean(confinan, na.rm = TRUE),
Business = mean(conbus, na.rm = TRUE),
Religion = mean(conclerg, na.rm = TRUE),
Education = mean(coneduc, na.rm = TRUE),
Exec_fed_gov = mean(confed, na.rm = TRUE),
Unions = mean(conlabor, na.rm = TRUE),
Medicine = mean(conmedic, na.rm = TRUE),
Supreme_court = mean(conjudge, na.rm = TRUE),
Science_comm = mean(consci, na.rm = TRUE),
Congress = mean(conlegis, na.rm = TRUE),
Military = mean(conarmy, na.rm = TRUE),
Age = mean(age, na.rm = TRUE),
Foreign = mean(born, na.rm = TRUE),
Party = mean(partyid == "Strong Democrat" / partyid == "Strong Republican", na.rm = TRUE))
gss_by_reg <- gss_16 %>% dplyr::group_by(region) %>%
dplyr::summarize(General = mean(trust, na.rm = TRUE),
Press = mean(conpress, na.rm = TRUE),
TV = mean(contv, na.rm = TRUE),
Finance = mean(confinan, na.rm = TRUE),
Business = mean(conbus, na.rm = TRUE),
Religion = mean(conclerg, na.rm = TRUE),
Education = mean(coneduc, na.rm = TRUE),
Exec_fed_gov = mean(confed, na.rm = TRUE),
Unions = mean(conlabor, na.rm = TRUE),
Medicine = mean(conmedic, na.rm = TRUE),
Supreme_court = mean(conjudge, na.rm = TRUE),
Science_comm = mean(consci, na.rm = TRUE),
Congress = mean(conlegis, na.rm = TRUE),
Military = mean(conarmy, na.rm = TRUE),
Age = mean(age, na.rm = TRUE),
Foreign = mean(born, na.rm = TRUE),
Party = mean(partyid == "Strong Democrat", na.rm = TRUE))
gss_by_reg$Party
gss_by_reg <- data.frame(sapply(gss_by_reg, function(x) as.numeric(as.character(x))))
gss_by_reg$region <- as.character(gss_by_reg$region)
US_map@data <- US_map@data %>%
left_join(gss_by_reg, by = c("DIVISIONCE" = "region"))
leaflet(US_map) %>% addTiles() %>%
addProviderTiles(providers$Stamen.Toner, group = "Toner") %>%
setView(lat=38.0000, lng=-97.0000, zoom = 4) %>%
addLegend("bottomright", colors = brewer.pal(4, "RdYlGn"),
labels = c("Lowest", "Low", "Medium", "High"),
title = "Level of Confidence<br/>(use layers to change variables)",
opacity = 0.5) %>%
addPolygons(fillColor = ~colorNumeric("RdYlGn", Press)(Press), stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = paste("Region:", US_map$NAME,"<br/>",
"Confidence in Press:", round(as.numeric(US_map$Press), 2),"<br/>",
"Confidence in TV:", round(as.numeric(US_map$TV), 2),"<br/>",
"Confidence in Congress:", round(as.numeric(US_map$Congress), 2)),
group = "Confidence in the Press") %>%
addPolygons(fillColor = ~colorNumeric("RdYlGn", Congress)(Congress), stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = paste("Region:", US_map$NAME,"<br/>",
"Confidence in Press:", round(as.numeric(US_map$Press), 2),"<br/>",
"Confidence in TV:", round(as.numeric(US_map$TV), 2),"<br/>",
"Confidence in Congress:", round(as.numeric(US_map$Congress), 2)),
group = "Confidence in the Congress") %>%
addPolygons(fillColor = ~colorNumeric("RdYlGn", Party)(Party), stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = paste("Region:", US_map$NAME,"<br/>",
"Confidence in Press:", round(as.numeric(US_map$Press), 2),"<br/>",
"Confidence in TV:", round(as.numeric(US_map$TV), 2),"<br/>",
"Confidence in Congress:", round(as.numeric(US_map$Congress), 2)),
group = "Age") %>%
addLayersControl(
baseGroups = c("Confidence in the Press", "Confidence in the Congress", "Age"),
options = layersControlOptions(collapsed = TRUE))
summ = paste("Region:", US_map$NAME,"<br/>",
"Confidence in Press:", round(as.numeric(US_map$Press), 2),"<br/>",
"Confidence in TV:", round(as.numeric(US_map$TV), 2),"<br/>",
"Confidence in Congress:", round(as.numeric(US_map$Congress), 2),"<br/>",
"Confidence in Supreme Court:", round(as.numeric(US_map$Supreme_court), 2),"<br/>",
"Confidence in Military:", round(as.numeric(US_map$Military), 2),"<br/>",
"Confidence in Organized Labor:", round(as.numeric(US_map$Unions), 2),"<br/>",
"Mean Age:", round(as.numeric(US_map$Age), 2),"<br/>",
"Foreign-born (%pop):", round(as.numeric(US_map$Foreign), 2))
leaflet(US_map) %>% addTiles() %>%
addProviderTiles(providers$Stamen.Toner, group = "Toner") %>%
setView(lat=38.0000, lng=-97.0000, zoom = 4) %>%
addLegend("bottomright", colors = brewer.pal(4, "RdYlGn"),
labels = c("Lowest", "Low", "Medium", "High"),
title = "Level of Confidence<br/>(use layers to change variables)",
opacity = 0.5) %>%
addPolygons(fillColor = ~colorNumeric("RdYlGn", Press)(Press), stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = summ,
group = "Confidence in the Press") %>%
addPolygons(fillColor = ~colorNumeric("RdYlGn", Congress)(Congress), stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = summ,
group = "Confidence in the Congress") %>%
addPolygons(fillColor = ~colorNumeric("RdYlGn", Supreme_court)(Supreme_court), stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = summ,
group = "Confidence in Supreme Court") %>%
addPolygons(fillColor = ~colorNumeric("RdYlGn", Military)(Military), stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = summ,
group = "Confidence in Military") %>%
addPolygons(fillColor = ~colorNumeric("RdYlGn", Unions)(Unions), stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = summ,
group = "Confidence in Organized Labor") %>%
addLayersControl(
baseGroups = c("Confidence in the Press", "Confidence in the Congress",
"Confidence in Supreme Court", "Confidence in Military",
"Confidence in Organized Labor"),
options = layersControlOptions(collapsed = TRUE))
US_map <- tigris::divisions()
gss_by_reg <- gss_16 %>% dplyr::group_by(region) %>%
dplyr::summarize(General = mean(trust, na.rm = TRUE),
Press = mean(conpress, na.rm = TRUE),
TV = mean(contv, na.rm = TRUE),
Finance = mean(confinan, na.rm = TRUE),
Business = mean(conbus, na.rm = TRUE),
Religion = mean(conclerg, na.rm = TRUE),
Education = mean(coneduc, na.rm = TRUE),
Exec_fed_gov = mean(confed, na.rm = TRUE),
Unions = mean(conlabor, na.rm = TRUE),
Medicine = mean(conmedic, na.rm = TRUE),
Supreme_court = mean(conjudge, na.rm = TRUE),
Science_comm = mean(consci, na.rm = TRUE),
Congress = mean(conlegis, na.rm = TRUE),
Military = mean(conarmy, na.rm = TRUE),
Age = mean(age, na.rm = TRUE),
Foreign = mean(1 - born, na.rm = TRUE) * 100)
gss_by_reg <- data.frame(sapply(gss_by_reg, function(x) as.numeric(as.character(x))))
gss_by_reg$region <- as.character(gss_by_reg$region)
US_map@data <- US_map@data %>%
left_join(gss_by_reg, by = c("DIVISIONCE" = "region"))
if (!require("leaflet")) {
install.packages("leaflet", dependencies = TRUE)
library(leaflet)}
if (!require("RColorBrewer")) {
install.packages("RColorBrewer", dependencies = TRUE)
library(RColorBrewer)}
summ = paste("Region:", US_map$NAME,"<br/>",
"Confidence in Press:", round(as.numeric(US_map$Press), 2),"<br/>",
"Confidence in TV:", round(as.numeric(US_map$TV), 2),"<br/>",
"Confidence in Congress:", round(as.numeric(US_map$Congress), 2),"<br/>",
"Confidence in Supreme Court:", round(as.numeric(US_map$Supreme_court), 2),"<br/>",
"Confidence in Military:", round(as.numeric(US_map$Military), 2),"<br/>",
"Confidence in Organized Labor:", round(as.numeric(US_map$Unions), 2),"<br/>",
"Mean Age:", round(as.numeric(US_map$Age), 2),"<br/>",
"Foreign-born (%pop):", round(as.numeric(US_map$Foreign), 2))
leaflet(US_map) %>% addTiles() %>%
addProviderTiles(providers$Stamen.Toner, group = "Toner") %>%
setView(lat=38.0000, lng=-97.0000, zoom = 4) %>%
addLegend("bottomright", colors = brewer.pal(4, "RdYlGn"),
labels = c("Lowest", "Low", "Medium", "High"),
title = "Level of Confidence<br/>(use layers to change variables)",
opacity = 0.5) %>%
addPolygons(fillColor = ~colorNumeric("RdYlGn", Press)(Press), stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = summ,
group = "Confidence in the Press") %>%
addPolygons(fillColor = ~colorNumeric("RdYlGn", Congress)(Congress), stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = summ,
group = "Confidence in the Congress") %>%
addPolygons(fillColor = ~colorNumeric("RdYlGn", Supreme_court)(Supreme_court), stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = summ,
group = "Confidence in Supreme Court") %>%
addPolygons(fillColor = ~colorNumeric("RdYlGn", Military)(Military), stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = summ,
group = "Confidence in Military") %>%
addPolygons(fillColor = ~colorNumeric("RdYlGn", Unions)(Unions), stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = summ,
group = "Confidence in Organized Labor") %>%
addLayersControl(
baseGroups = c("Confidence in the Press", "Confidence in the Congress",
"Confidence in Supreme Court", "Confidence in Military",
"Confidence in Organized Labor"),
options = layersControlOptions(collapsed = TRUE))
age16 %>%
group_by(age_group)%>%
summarize(mean_scores = mean(conpress))%>%
ggplot(aes(x = age_group, y = mean_scores, fill = age_group,alpha=0.3)) +
geom_bar(stat = "identity") + geom_text(aes(label=round(mean_scores,2), size = 10, fontface = "bold", vjust=4))+ labs(x = "Age Group", y = "Confidence Level")+ggtitle("Confidence in Media by Age Group") + theme(plot.title=element_text(size=rel(1.1), lineheight=.9,face="italic",colour="black"))+ theme_tufte()+theme(legend.position="none")+ scale_y_continuous(limit = c(0,2), breaks = c(0,1,2), labels = c("Hardly Any", "Only some", "A great deal"))
# Confidence in Press level by Political Affiliation in 2016
ggplot(gss_16[!is.na(gss_16$partyid),], aes(x = as.factor(partyid), fill = as.factor(partyid))) +
stat_summary(aes(y = as.numeric(conpress)), fun.y = "mean", geom = "bar") +
coord_flip() +labs(title = "Confidence in Press Levels by Political Affiliation",
y = "Confidence in the Press", x = "") +
scale_y_continuous(limits = c(0, 2), breaks = 0:2, labels = c("Hardly any", "Only some", "A great deal")) +
ggthemes::theme_tufte() + theme(legend.position = "none", axis.text.x = element_text(angle=90))
# Import data
gss_sub2 <- read.csv("Data/gss_sub.csv")
gss_sub2$conpress <- 3 - gss_sub2$conpress
yr16 <- subset(gss_sub2, gss_sub2$year == 2016)
# Confidence in Media by age group
age16 <- na.omit(yr16[,c("age_group","conpress")])
age16 %>%
group_by(age_group)%>%
summarize(mean_scores = mean(conpress))%>%
ggplot(aes(x = age_group, y = mean_scores, fill = age_group,alpha=0.3)) +
geom_bar(stat = "identity") + geom_text(aes(label=round(mean_scores,2), size = 10, fontface = "bold", vjust=4))+ labs(x = "Age Group", y = "Confidence Level")+ggtitle("Confidence in Media by Age Group") + theme(plot.title=element_text(size=rel(1.1), lineheight=.9,face="italic",colour="black"))+ theme_tufte()+theme(legend.position="none")+ scale_y_continuous(limit = c(0,2), breaks = c(0,1,2), labels = c("Hardly Any", "Only some", "A great deal"))
age16 %>%
dplyr::group_by(age_group)%>%
dplyr::summarize(mean_scores = mean(conpress))%>%
ggplot(aes(x = age_group, y = mean_scores, fill = age_group,alpha=0.3)) +
geom_bar(stat = "identity") + geom_text(aes(label=round(mean_scores,2), size = 10, fontface = "bold", vjust=4))+ labs(x = "Age Group", y = "Confidence Level")+ggtitle("Confidence in Media by Age Group") + theme(plot.title=element_text(size=rel(1.1), lineheight=.9,face="italic",colour="black"))+ theme_tufte()+theme(legend.position="none")+ scale_y_continuous(limit = c(0,2), breaks = c(0,1,2), labels = c("Hardly Any", "Only some", "A great deal"))
table(mideast$M301L)
table(5 - as.numeric(mideast$M301L))
mideast_cool <- group_by(mideast, countries) %>%
summarise(Press = mean(5 - as.numeric(M301L), na.rm = T),
TV = mean(5 - as.numeric(M301H), na.rm = T),
Polit_parties <- mean(5 - as.numeric(M301C), na.rm = T))
mideast_cool
mideast_cool <- dplyr::group_by(mideast, countries) %>%
dplyr::summarise(Press = mean(5 - as.numeric(M301L), na.rm = T),
TV = mean(5 - as.numeric(M301H), na.rm = T),
Polit_parties <- mean(5 - as.numeric(M301C), na.rm = T))
mideast_cool
mideast_cool <- dplyr::group_by(mideast, countries) %>%
dplyr::summarise(Press = mean(5 - as.numeric(M301L), na.rm = T),
TV = mean(5 - as.numeric(M301H), na.rm = T),
Polit_parties = mean(5 - as.numeric(M301C), na.rm = T))
mideast_cool <- dplyr::group_by(mideast, countries) %>%
dplyr::summarise(Press = mean(5 - as.numeric(M301L), na.rm = T),
TV = mean(5 - as.numeric(M301H), na.rm = T),
Polit_parties = mean(5 - as.numeric(M301C), na.rm = T))
if (!require("rworldmap")) {
install.packages("rworldmap", dependencies = TRUE)
library(rworldmap)}
mideast_map <- getMap()
mideast_map <- mideast_map[as.character(mideast_map$NAME) %in% mideast$countries, ]
mideast_map@data <- mideast_map@data %>%
left_join(mideast_cool, by = c("NAME" = "countries"))
if (!require("leaflet")) {
install.packages("leaflet", dependencies = TRUE)
library(leaflet)}
leaflet(mideast_map) %>%
addProviderTiles(providers$Stamen.Toner, group = "Toner")  %>%
addLegend("bottomright", colors = brewer.pal(4, "RdYlGn"),
labels = c("Lowest", "Low", "Medium", "High"),
title = "Level of Trust<br/>(use layers to change variables)",
opacity = 0.5) %>%
addPolygons(group = "Trust in Press",
stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
color = ~colorNumeric("RdYlGn", Press)(Press),
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = paste("Country:", mideast_map$NAME,"<br/>",
"Trust in Press:", round(mideast_map$Press, 2),"<br/>",
"Trust in TV:", round(mideast_map$TV, 2),"<br/>",
"Trust in Political Parties:", round(mideast_map$Polit_parties, 2))) %>%
addPolygons(group = "Trust in Political Parties",
stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
color = ~colorNumeric("RdYlGn", Press)(Press),
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = paste("Country:", mideast_map$NAME,"<br/>",
"Trust in Press:", round(mideast_map$Press, 2),"<br/>",
"Trust in TV:", round(mideast_map$TV, 2),"<br/>",
"Trust in Political Parties:", round(mideast_map$Polit_parties, 2))) %>%
addLayersControl(
baseGroups = c("Trust in Press", "Trust in Political Parties"),
options = layersControlOptions(collapsed = TRUE))
leaflet(mideast_map) %>%
addProviderTiles(providers$Stamen.Toner, group = "Toner")  %>%
addLegend("bottomright", colors = brewer.pal(4, "RdYlGn"),
labels = c("Lowest", "Low", "Medium", "High"),
title = "Level of Trust<br/>(use layers to change variables)",
opacity = 0.5) %>%
addPolygons(group = "Trust in Press",
stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
color = ~colorNumeric("RdYlGn", Press)(Press),
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = paste("Country:", mideast_map$NAME,"<br/>",
"Trust in Press:", round(mideast_map$Press, 2),"<br/>",
"Trust in TV:", round(mideast_map$TV, 2),"<br/>",
"Trust in Political Parties:", round(mideast_map$Polit_parties, 2))) %>%
addPolygons(group = "Trust in Political Parties",
stroke = FALSE,
fillOpacity = 0.4, smoothFactor = 0.5,
color = ~colorNumeric("RdYlGn", Polit_parties)(Polit_parties),
highlight = highlightOptions(
weight = 5, color = "white",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = paste("Country:", mideast_map$NAME,"<br/>",
"Trust in Press:", round(mideast_map$Press, 2),"<br/>",
"Trust in TV:", round(mideast_map$TV, 2),"<br/>",
"Trust in Political Parties:", round(mideast_map$Polit_parties, 2))) %>%
addLayersControl(
baseGroups = c("Trust in Press", "Trust in Political Parties"),
options = layersControlOptions(collapsed = TRUE))
leaflet(world_dat) %>%
setView(lat=10, lng=0 , zoom=2) %>%
addProviderTiles(providers$Stamen.Toner, group = "Toner")  %>%
addPolygons(group="Confidence Level",
stroke = FALSE, fillOpacity = 0.5, smoothFactor = 0.5,
color = ~colorQuantile("RdYlGn", Conf)(Conf),
popup = paste("Country:",world_dat$name_long,"<br/>",
"Confidence in Press:", round(world_dat$Conf,1),"<br/>",
"Average Education Level:",round(world_dat$EduLevel,0))) %>%
addPolygons(group="% by Edu Level",
stroke = FALSE, color = ~colorQuantile("RdYlGn", EduLevel)(EduLevel),
popup = paste("No Education:",world_dat$No.Edu,"<br/>",
"Primary:",world_dat$Primary,"<br/>",
"Secondary:",world_dat$Secondary,"<br/>",
"University:",world_dat$University)) %>%
addLayersControl(
baseGroups = c("Confidence Level","% by Edu Level"),
options = layersControlOptions(collapsed = TRUE)) %>%
addLegend("bottomright",
pal = colorNumeric("RdYlGn", world_dat$conf), values = ~Conf,
title = "Confidence in Press <br>
1 = A great deal<br>
2 = Quite a lot<br>
3 = Not very much<br>
4 = None at all", opacity = 0.5)
